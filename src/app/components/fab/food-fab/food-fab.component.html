<ion-fab slot="fixed" vertical="bottom" horizontal="end">
  <ion-fab-button>
    <ion-icon name="chevron-up-circle"></ion-icon>
  </ion-fab-button>
  <ion-fab-list side="top">
    <ion-fab-button><ion-icon name="add-outline" (click)="setOpen(true)"></ion-icon></ion-fab-button>
    <ion-fab-button *ngIf="grid==0" (click)="changeGrid()"><ion-icon name="list-outline"></ion-icon></ion-fab-button>
    <ion-fab-button *ngIf="grid==1" (click)="changeGrid()"><ion-icon name="apps-outline"></ion-icon></ion-fab-button>
    <ion-fab-button *ngIf="grid==2" (click)="changeGrid()"><ion-icon name="grid-outline"></ion-icon></ion-fab-button>
  </ion-fab-list>
</ion-fab>

<ion-modal [isOpen]="isModalOpen">
  <ng-template>
    <ion-header>
      <ion-toolbar>
        <ion-buttons slot="start" class="tercio">
          <ion-button (click)="setOpen(false)">
            <ion-icon name="chevron-back-outline"></ion-icon>
            Cancel
          </ion-button>
        </ion-buttons>
        <ion-title>Producto</ion-title>
        <ion-buttons slot="end" class="tercio">
          <ion-button (click)="clean()">
            <ion-icon class="sep" name="trash-bin-outline"></ion-icon>
            Limpiar
          </ion-button>
        </ion-buttons>
      </ion-toolbar>
    </ion-header>

    <ion-content class="ion-padding">
      <!-- Añadir código de barras -->
      <ion-item>
        <ion-input label="Código de barras" labelPlacement="stacked" placeholder="Código de barras" pattern="[0-9]{13}"
          #id></ion-input>
        <ion-button fill="clear" (click)="showProducts(id.value+'')">Buscar</ion-button>
      </ion-item>

      <!-- Carta con el producto -->
      <div *ngIf="products.length > 0">
        <!-- Carta de producto -->
        <ion-card *ngFor="let p of products">
          <!-- Header con el nombre -->
          <ion-card-header>
            <ion-card-title>{{p.name}}</ion-card-title>
          </ion-card-header>
          <!-- Contenido - ingredientes y la foto -->
          <ion-card-content>
            <ion-img loading="lazy" src="{{p.picture}}" alt="{{p.name}}"></ion-img>
          </ion-card-content>
        </ion-card>
        <!-- Cantidad -->
        <ion-title>Añadir/quitar producto</ion-title>
        <ion-item>
          <ion-grid>
            <ion-row>
              <!-- Sumar -->
              <ion-col>
                <ion-button fill="clear" class="tercio" (click)="changeQuantity('add')">+</ion-button>
              </ion-col>
              <!-- Escribir numero y mostrar valor -->
              <ion-col>
                <ion-input (change)="changeQuantityNumber(+(quantity.value+'')+0)" class="tercio"
                  value="{{products[0].quantity.number}}" type="number" #quantity></ion-input>
              </ion-col>
              <!-- Restar -->
              <ion-col>
                <ion-button fill="clear" class="tercio" [disabled]="products[0].quantity.number <= 0"
                  (click)="changeQuantity('remove')">-</ion-button>
              </ion-col>
            </ion-row>
          </ion-grid>
        </ion-item>

        <!-- Tipo - bricks, gramos, botellas, packs... -->
        <ion-item>
          <ion-input label="Tipo de cantidad" labelPlacement="stacked" placeholder="Bricks, gramos, botellas, packs..."
            pattern="[a-zA-Z.,]+" (change)="changeQuantity('type', type.value+'')" #type></ion-input>
        </ion-item>

        <!-- Boton de enviar -->
        <ion-grid class="center">
          <ion-row>
            <ion-col>
              <ion-button (click)="addProductToUser()">
                <ion-icon class="sep" name="save-outline"></ion-icon>
                Añadir
              </ion-button>
            </ion-col>
          </ion-row>
        </ion-grid>
      </div>

      <!-- <app-qrbarcode></app-qrbarcode> -->
    </ion-content>
  </ng-template>
</ion-modal>

<ion-toast [isOpen]="isToastOpen" message="Producto agregado con éxito." [duration]="4000"
  (didDismiss)="setToastOpen(false)"></ion-toast>